/*
 * This file is part of the TYPO3 CMS project.
 *
 * It is free software; you can redistribute it and/or modify it under
 * the terms of the GNU General Public License, either version 2
 * of the License, or any later version.
 *
 * For the full copyright and license information, please read the
 * LICENSE.txt file that was distributed with this source code.
 *
 * The TYPO3 project - inspiring people to share!
 */
define(["require","exports","jquery","TYPO3/CMS/Backend/DocumentSaveActions","datatables"],function(e,a,t,l){"use strict";return new(function(){return function(){var e=this;this.allCheckedStatus=!1,this.actOnChangedTaskClass=function(e){var a=e.val();a=a.toLowerCase().replace(/\\/g,"-"),t(".extraFields").hide(),t(".extra_fields_"+a).show()},this.actOnChangedTaskType=function(a){e.toggleFieldsByTaskType(t(a.currentTarget).val())},this.actOnChangeSchedulerTableGarbageCollectionAllTables=function(e){var a=t("#task_tableGarbageCollection_numberOfDays"),l=t("#task_tableGarbageCollection_table");if(e.prop("checked"))l.prop("disabled",!0),a.prop("disabled",!0);else{var n=parseInt(a.val(),10);if(n<1){var s=l.val();void 0!==defaultNumberOfDays[s]&&(n=defaultNumberOfDays[s])}l.prop("disabled",!1),n>0&&a.prop("disabled",!1)}},this.actOnChangeSchedulerTableGarbageCollectionTable=function(e){var a=t("#task_tableGarbageCollection_numberOfDays");defaultNumberOfDays[e.val()]>0?(a.prop("disabled",!1),a.val(defaultNumberOfDays[e.val()])):(a.prop("disabled",!0),a.val(0))},this.checkOrUncheckAllCheckboxes=function(a){return a.parents(".tx_scheduler_mod1_table").find(":checkbox").prop("checked",!e.allCheckedStatus),e.allCheckedStatus=!e.allCheckedStatus,!1},this.toggleFieldsByTaskType=function(e){e=parseInt(e+"",10),t("#task_end_col").toggle(2===e),t("#task_frequency_row").toggle(2===e)},this.toggleTaskGroups=function(e){var a=e.data("task-group-id");t("#recordlist-task-group-"+a).collapse("toggle")},this.initializeEvents=function(){t(".checkall").on("click",function(a){e.checkOrUncheckAllCheckboxes(t(a.currentTarget))}),t("#task_class").change(function(a){e.actOnChangedTaskClass(t(a.currentTarget))}),t("#task_type").change(e.actOnChangedTaskType),t("#task_tableGarbageCollection_allTables").change(function(a){e.actOnChangeSchedulerTableGarbageCollectionAllTables(t(a.currentTarget))}),t("#task_tableGarbageCollection_table").change(function(a){e.actOnChangeSchedulerTableGarbageCollectionTable(t(a.currentTarget))}),t(".taskGroup").on("click",function(a){e.toggleTaskGroups(t(a.currentTarget))}),t("table.taskGroup-table").DataTable({paging:!1,searching:!1})},this.initializeDefaultStates=function(){var a=t("#task_type");a.length&&e.toggleFieldsByTaskType(a.val());var l=t("#task_class");l.length&&e.actOnChangedTaskClass(l)},this.initializeEvents(),this.initializeDefaultStates(),l.getInstance().addPreSubmitCallback(function(){var e=t("#task_class").val();e=e.toLowerCase().replace(/\\/g,"-"),t(".extraFields").appendTo(t("#extraFieldsHidden")),t(".extra_fields_"+e).appendTo(t("#extraFieldsSection"))})}}())});